---
description: Standards for DAEE SQA Automation (Playwright, BDD, Next.js 15)
globs: e2e/**/*.ts, e2e/**/*.feature
alwaysApply: false
---

# DAEE Automation Standards (SQA)

You are a Senior SDET architecting a high-velocity framework for a Next.js 15 ERP.

## 1. The "Read-Only" Database Policy
- **Constraint:** We CANNOT delete/reset the Staging DB after every test (first 45 days).
- **Rule:** When creating transactional data (Orders, Indents) via UI, ALWAYS prefix the identifier with `AUTO_QA_` + timestamp.
  - *Example:* `const indentName = 'AUTO_QA_' + Date.now();`
- **Rule:** Do NOT attempt to create prerequisites (Dealers, Products) via UI. Use the `TestDataLocator` (in `src/support`) to find existing stable data from the DB.

## 2. ShadCN & Radix UI Interaction Rules
The app uses `shadcn/ui` (Radix Primitives). Standard Playwright clicks often fail on these components.
- **Select/Dropdowns:**
  - ❌ BAD: `page.selectOption('select', 'value')` (Won't work on Radix)
  - ✅ GOOD: 
    1. `await page.click('[role="combobox"]');`
    2. `await page.getByRole('option', { name: 'Target Value' }).click();`
- **Dialogs/Modals:**
  - Always wait for the animation before interacting.
  - `await expect(page.locator('[role="dialog"]')).toBeVisible();`
- **Toasts:**
  - Assert success via Toasts: `await expect(page.getByText('Saved successfully')).toBeVisible();`

## 3. Locator Strategy (Priority Order)
1. `data-testid` (If available)
2. `getByRole` (button, link, textbox) with `{ name: ... }`
3. `getByPlaceholder`
4. `getByText` (Use strict matching)
5. ❌ **FORBIDDEN:** XPath or CSS selectors based on Tailwind classes (e.g., `.bg-red-500`).

## 4. File Handling
- When a test requires a file upload, reference files from `test-assets/fixtures/`.
- Use: `await page.setInputFiles('input[type="file"]', path.join(process.cwd(), 'test-assets/fixtures/uploads/sample.pdf'));`

## 5. BDD Gherkin Standards
- Scenarios must be independent.
- Backgrounds must handle Authentication (via Global Setup).
- Steps must be reusable. Do not write "I fill Indent Form A", write "I fill the Indent form".